{"version":3,"file":"zaf_sdk.js","mappings":"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","sources":["webpack://ZAFClient/webpack/universalModuleDefinition","webpack://ZAFClient/./lib/utils/idleState.ts","webpack://ZAFClient/./lib/utils/listeners.ts","webpack://ZAFClient/./lib/utils.js","webpack://ZAFClient/./lib/tracker.js","webpack://ZAFClient/./lib/client.js","webpack://ZAFClient/./lib/index.js","webpack://ZAFClient/./node_modules/native-promise-only/lib/npo.src.js","webpack://ZAFClient/webpack/bootstrap","webpack://ZAFClient/webpack/runtime/compat get default export","webpack://ZAFClient/webpack/runtime/define property getters","webpack://ZAFClient/webpack/runtime/global","webpack://ZAFClient/webpack/runtime/hasOwnProperty shorthand","webpack://ZAFClient/webpack/startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ZAFClient\"] = factory();\n\telse\n\t\troot[\"ZAFClient\"] = factory();\n})(self, () => {\nreturn ","import Observers, { ListenerFunction } from './listeners';\n\nconst USER_EVENTS = ['mousemove', 'keydown', 'wheel', 'mousedown', 'touchstart', 'touchmove'];\n// list of user events to ignore when window hasn't focus as string, i.e. 'mousemove touchmove'\nconst IGNORED_USER_EVENTS = 'mousemove';\n\nclass IdleState {\n  refcount?: number;\n  hasFocus?: boolean;\n  userEventListenerAdded?: boolean;\n  observers?: Observers;\n\n  constructor() {\n    this.hasFocus = true;\n    this.userEventListenerAdded = false;\n    this.observers = new Observers();\n\n    this.refcount = 1;\n\n    // Bind callbacks\n    this.handleVisibilityChange = this.handleVisibilityChange.bind(this);\n    this.handleFocusChange = this.handleFocusChange.bind(this);\n    this.handleUserEvent = this.handleUserEvent.bind(this);\n\n\n    // Install listeners and timer\n    document.addEventListener('visibilitychange', this.handleVisibilityChange, true);\n\n    // Because Safari dispatches focus events before visibilitychange, we need to register focus/blurr listener here\n    // and not inside handleVisibilityChange with the other event listeners\n    window.addEventListener('focus', this.handleFocusChange, true);\n    window.addEventListener('blur', this.handleFocusChange, true);\n\n    this.handleVisibilityChange();\n  }\n\n  delete(): void {\n    if (this.refcount !== undefined && --this.refcount === 0) {\n      document.removeEventListener('visibilitychange', this.handleVisibilityChange, true);\n      window.removeEventListener('focus', this.handleFocusChange, true);\n      window.removeEventListener('blur', this.handleFocusChange, true);\n\n      if (this.userEventListenerAdded) {\n        USER_EVENTS.forEach((type) =>\n          document.removeEventListener(type, this.handleUserEvent, true)\n        );\n      }\n      delete this.observers;\n    }\n  }\n\n  markActive(): void{\n    this.observers && this.observers.call(null)\n  }\n\n  handleUserEvent(event: Event): void {\n    if (!this.hasFocus && IGNORED_USER_EVENTS.includes(event.type)) return;\n\n    this.markActive();\n  }\n\n  handleFocusChange(event: Event): void {\n    // we only care about focus/blur event related to the window itself\n    if (event.target !== window) return;\n\n    this.hasFocus = event.type === 'focus';\n    if (this.hasFocus) {\n      this.markActive();\n    }\n  }\n\n  handleVisibilityChange(): void {\n    if (document.hidden) {\n      if (this.userEventListenerAdded) {\n        USER_EVENTS.forEach((type) =>\n          document.removeEventListener(type, this.handleUserEvent, true)\n        );\n        this.userEventListenerAdded = false;\n      }\n    } else if (!this.userEventListenerAdded) {\n      USER_EVENTS.forEach((type) => document.addEventListener(type, this.handleUserEvent, true));\n      this.userEventListenerAdded = true;\n    }\n  }\n\n  addObserver(observer: ListenerFunction): (() => void) | undefined {\n    return this.observers && this.observers.add(observer);\n  }\n}\n\nexport default IdleState;\n","export type ListenerFunction = (...args: unknown[]) => void;\n\ninterface Listener {\n  fn: ListenerFunction;\n  count: number;\n}\n\nclass Listeners {\n  private listeners: Listener[];\n\n  constructor() {\n    this.listeners = [];\n  }\n\n  add(listener: ListenerFunction): () => void {\n    const find = (listener: ListenerFunction) =>\n      this.listeners.findIndex((item) => item.fn === listener);\n\n    const index = find(listener);\n    if (index === -1) {\n      this.listeners.push({ fn: listener, count: 1 });\n    } else {\n      const listener = this.listeners[index];\n      listener && listener.count++;\n    }\n\n    return () => {\n      const index = find(listener);\n\n      if (index !== -1) {\n        const listener = this.listeners[index];\n        listener && listener.count--;\n        if (listener && listener.count === 0) {\n          this.listeners.splice(index, 1);\n        }\n      }\n    };\n  }\n\n  call(...args: unknown[]): void {\n    this.listeners.forEach((listener) => listener.fn(...args));\n  }\n}\n\nexport default Listeners;\n","import NativePromise from 'native-promise-only'\nconst Promise = window.Promise || NativePromise\n\nexport function isObject (obj) {\n  return (obj !== null && typeof obj === 'object')\n}\n\nfunction decode (s) {\n  return decodeURIComponent((s || '').replace(/\\+/g, ' '))\n}\n\nexport function queryParameters (queryString) {\n  queryString = queryString || ''\n\n  const result = {}\n  let keyValuePairs, keyAndValue, key, value\n\n  if (queryString.search(/\\?|#/) === 0) {\n    queryString = queryString.slice(1)\n  }\n\n  if (queryString.length === 0) { return result }\n\n  keyValuePairs = queryString.split('&')\n\n  for (let i = 0; i < keyValuePairs.length; i++) {\n    keyAndValue = keyValuePairs[i].split('=')\n    key = decode(keyAndValue[0])\n    value = decode(keyAndValue[1]) || ''\n    result[key] = value\n  }\n\n  return result\n}\n\nfunction isPromise (obj) {\n  if (obj instanceof Promise) return true\n  return !!obj && obj.then && typeof obj.then === 'function'\n}\n\nfunction shouldReject (val) {\n  return val === false ||\n    val instanceof Error ||\n    typeof val === 'string'\n}\n\nexport function isString (key) {\n  return typeof key === 'string'\n}\n\n// When receives a list of things to wrap as Promises.\n// it will then wait for:\n//  a) all to settle\n//  b) first to reject\n//  c) first to settle with a falsy value\n// c) is sub-optimal, since it has a specific narrow use-case\n// for save hooks\nexport function when (items) {\n  items = items || []\n  let resolveAll, rejectAll\n  const allResolvedPromise = new Promise((resolve, reject) => {\n    resolveAll = resolve\n    rejectAll = reject\n  })\n\n  let remaining = 0\n  const settledWith = []\n  const itemsCopy = Array.isArray(items) ? items.slice() : [items]\n\n  function resolveWith (data, index) {\n    settledWith[index] = data\n\n    if (--remaining <= 0) {\n      resolveAll(settledWith)\n    }\n  }\n\n  remaining = itemsCopy.length\n\n  if (remaining <= 0) {\n    resolveAll()\n    return allResolvedPromise\n  }\n\n  itemsCopy.forEach((item, index) => {\n    let promise\n    if (isPromise(item)) {\n      promise = item\n    } else if (typeof item === 'function') {\n      let res\n      try {\n        res = item()\n        if (isPromise(res)) {\n          promise = res\n        } else if (shouldReject(res)) {\n          promise = Promise.reject(res)\n        } else {\n          promise = Promise.resolve(res)\n        }\n      } catch (err) {\n        promise = Promise.reject(err)\n      }\n    } else {\n      promise = new Promise((resolve, reject) => {\n        shouldReject(item)\n          ? reject(item)\n          : resolve(item)\n      })\n    }\n    promise.then((data) => {\n      resolveWith(data, index)\n    }).catch(rejectAll.bind(rejectAll))\n  })\n\n  return allResolvedPromise\n}\n\nexport function debounce (func, timeout) {\n  let time\n  return (...args) => {\n    clearTimeout(time)\n    time = setTimeout(() => { func.apply(this, args) }, timeout)\n  }\n}\n","export default class Tracker {\n  constructor (client) {\n    this.startTime = Date.now()\n    this.client = client\n    this.MIN_HOVER_TIME = 200 // milliseconds\n  }\n\n  handleMouseEnter () {\n    this.startTime = Date.now()\n  }\n\n  handleMouseLeave () {\n    const overFor = Date.now() - this.startTime\n    if (overFor >= this.MIN_HOVER_TIME) {\n      this.client.invoke('track', { type: 'hover', value: overFor })\n    }\n  }\n\n  handleClick () {\n    this.client.invoke('track', { type: 'click' })\n  }\n\n  setup () {\n    const $html = document.querySelector('html')\n    $html.addEventListener('click', this.handleClick.bind(this))\n    $html.addEventListener('mouseleave', this.handleMouseLeave.bind(this))\n    $html.addEventListener('mouseenter', this.handleMouseEnter.bind(this))\n  }\n}\n","/* global URL */\nimport pkgJson from '../package.json'\nimport { when, isObject, isString, debounce } from './utils'\nimport IdleState from './utils/idleState'\nimport Tracker from './tracker'\nimport NativePromise from 'native-promise-only'\n\nconst Promise = window.Promise || NativePromise\n\nexport const IFRAME_SESSION_TIMEOUT = 5 * 60 * 1000 // Set timeout for iframe sessions to 5 minutes.\nexport const PROMISE_TIMEOUT = 10000\n// 10 seconds, see ZD#4058685\nexport const PROMISE_TIMEOUT_LONG = 5 * 60 * 1000\n// Set a high timeout threshold to allow us to better gauge the time taken for successful requests\nconst NO_TIMEOUT_ACTIONS = ['instances.create']\nconst ZAF_EVENT = /^zaf\\./\nconst pendingPromises = {}\nconst ids = {}\n\n// // export Promise!\nwindow.Promise = Promise\n\n// @internal\n// #timeoutReject(rejectionFn, name, client, params)\n//\n// Reject a request if required, given the rejection function, name (get, set or invoke)\n// and arguments to that request. Falls back to 10000 second timeout with few exceptions.\n//\nfunction timeoutReject (client, reject, name, paramsArray) {\n  const actions = collateActions(name, paramsArray)\n  switch (name) {\n    case 'invoke': {\n      const matches = paramsArray.filter((action) => {\n        return NO_TIMEOUT_ACTIONS.indexOf(action) !== -1\n      })\n      const allWhitelisted = matches.length === paramsArray.length\n      if (allWhitelisted) {\n        return NaN // timer IDs are numbers; embrace the JavaScript ðŸ˜¬\n      } else {\n        const notAllWhitelisted = matches.length !== 0\n        if (notAllWhitelisted) {\n          throw new Error('Illegal bulk call - `instances.create` must be called separately.')\n        }\n        return defaultTimer(client, actions, reject)\n      }\n    }\n    default: {\n      return defaultTimer(client, actions, reject)\n    }\n  }\n}\n\nfunction defaultTimer (client, actions, callback) {\n  return setTimeout(() => {\n    trackSDKRequestTimeout(client, actions, PROMISE_TIMEOUT_LONG)\n    callback(new Error('Invocation request timeout'))\n  }, PROMISE_TIMEOUT_LONG)\n}\n\nexport function collateActions (name, params) { return params.map(action => `${name}-${action}`) }\n\nexport function stripActionArgs (action) {\n  // Capture:\n  // 1. single or multiple comma-delimited arguments following an initial colon, and\n  // 2. non-whitelisted, unescaped words following a period (i.e. file extensions in the case of assetURL calls)\n  const ACTION_ARGS = /:\\w+(,?\\w+)*((\\.(show|hide|enable|disable))|(\\\\?\\.\\w*))?/g\n  // Return :arg.field_modifier, where field modifier is (optionally) one of 'show', 'hide', 'enable' or 'disable'\n  return action.replace(ACTION_ARGS, ':arg$3')\n}\n\nexport function timeMsToSecondsRange (value, upperLimit = PROMISE_TIMEOUT_LONG) {\n  if (value >= upperLimit) return `${upperLimit / 1000}-`\n  const lowerRangeBound = value - (value % 10000)\n  return `${lowerRangeBound / 1000}-${(lowerRangeBound + 10000) / 1000}`\n}\n\nexport function trackSDKRequestTimeout (client, actions, requestResponseTime) {\n  const actionsTags = actions.map(action => `action:${stripActionArgs(action)}`)\n  const responseTimeTag = `request_response_time:${timeMsToSecondsRange(requestResponseTime)}`\n  client.postMessage('__track__', {\n    event_name: 'sdk_request_timeout',\n    event_type: 'increment',\n    data: 1,\n    tags: actionsTags.concat(responseTimeTag)\n  })\n}\n\nfunction nextIdFor (name) {\n  if (isNaN(ids[name])) {\n    ids[name] = 0\n  }\n  return ++ids[name]\n}\n\n// @internal\n// #### rawPostMessage(client, msg, forceReady)\n//\n// Post a message to the hosting frame.\n// If the client is not ready and forceReady is not specified, it will wait for client registration.\n//\nfunction rawPostMessage (client, msg, forceReady) {\n  if (client.ready || forceReady) {\n    client._source.postMessage(msg, client._origin)\n  } else {\n    client.on('app.registered', rawPostMessage.bind(null, client, msg))\n  }\n}\n\n// @internal\n// #### wrappedPostMessage(name, params)\n//\n// Wraps post message with a request/response mechanism using Promises.\n// Must be invoked in the context of a Client.\n//\n// ##### Arguments\n//\n//   * `name` the name of the request to make (get/set/invoke)\n//   * `params` parameters of the request (an array for get, and an object for set/invoke)\n//\nfunction wrappedPostMessage (name, params) {\n  const id = nextIdFor('promise')\n  let timeoutId, promiseStartTime\n  const paramsArray = Array.isArray(params) ? params : Object.keys(params)\n  const actions = collateActions(name, paramsArray)\n  const client = this\n\n  const promise = new Promise((resolve, reject) => {\n    promiseStartTime = window.performance.now()\n\n    // Time out the promise to ensure it will be garbage collected if nobody responds\n    timeoutId = timeoutReject(client, reject, name, paramsArray)\n    pendingPromises[id] = { resolve, reject }\n\n    const msg = JSON.stringify({\n      id: id,\n      request: name,\n      params: params,\n      appGuid: client._appGuid,\n      instanceGuid: client._instanceGuid\n    })\n    rawPostMessage(client, msg)\n  })\n\n  const trackTimeoutWithResolutionTime = () => {\n    const promiseResolutionTime = window.performance.now() - promiseStartTime\n    if (promiseResolutionTime > PROMISE_TIMEOUT) {\n      trackSDKRequestTimeout(client, actions, promiseResolutionTime)\n    }\n  }\n\n  // ensure promise is cleaned up when resolved/rejected, track request performance for resolved promises\n  return promise.then(\n    removePromise.bind(null, { id, timeoutId, trackTimeoutWithResolutionTime }),\n    removePromise.bind(null, { id, timeoutId })\n  )\n}\n\nfunction createError (error) {\n  if (error.path) { error.message = '\"' + error.path + '\" ' + error.message }\n  const err = new Error(error.message)\n  err.name = error.name\n  err.stack = error.stack\n  return err\n}\n\nfunction removePromise (options, args) {\n  clearTimeout(options.timeoutId)\n  delete pendingPromises[options.id]\n  options.trackTimeoutWithResolutionTime && options.trackTimeoutWithResolutionTime()\n  if (args instanceof Error) throw args\n  return args\n}\n\nfunction isValidEvent (client, event) {\n  return client && client._origin === event.origin && client._source === event.source\n}\n\nfunction triggerEvent (client, eventName, data) {\n  if (!client._messageHandlers[eventName]) { return false }\n  client._messageHandlers[eventName].forEach((handler) => {\n    handler(data)\n  })\n}\n\nfunction finalizePendingPromise (pendingPromise, data) {\n  if (data.error) {\n    const error = data.error.name ? createError(data.error) : data.error\n    pendingPromise.reject(error)\n  } else {\n    pendingPromise.resolve(data.result)\n  }\n}\n\nfunction postReplyWith (client, key, msg) {\n  if (client._repliesPending[key]) { return }\n  msg.key = 'iframe.reply:' + key\n  client._repliesPending[key] = true\n  return when(client._messageHandlers[key]).then(\n    rawPostMessage.bind(null, client, msg)\n  ).catch((reason) => {\n    // if the handler throws an error we want to send back its message, but\n    // Error objects don't pass through the postMessage boundary.\n    const rejectMessage = reason instanceof Error ? reason.message : reason\n    msg.error = {\n      msg: rejectMessage\n    }\n    rawPostMessage(client, msg)\n  }).then(() => {\n    delete client._repliesPending[key]\n  })\n}\n\nfunction getMessageRecipient (client, recipientGuid) {\n  let messageRecipient = client\n\n  if (recipientGuid && recipientGuid !== client._instanceGuid) {\n    messageRecipient = client._instanceClients[recipientGuid]\n\n    if (!messageRecipient) {\n      throw Error('[ZAF SDK] Could not find client for instance ' + recipientGuid)\n    }\n  }\n\n  return messageRecipient\n}\n\nfunction messageHandler (client, event) {\n  if (!isValidEvent(client, event)) { return }\n\n  let data = event.data\n\n  if (!data) { return }\n\n  if (typeof data === 'string') {\n    try {\n      data = JSON.parse(event.data)\n    } catch (e) {\n      return e\n    }\n  }\n\n  const clientRecipient = getMessageRecipient(client, data.instanceGuid)\n  let pendingPromise\n\n  if (data.id && (pendingPromise = pendingPromises[data.id])) {\n    finalizePendingPromise(pendingPromise, data)\n  } else if (ZAF_EVENT.test(data.key)) {\n    const key = data.key.replace(ZAF_EVENT, '')\n    const msg = { appGuid: client._appGuid }\n\n    if (data.needsReply) {\n      return postReplyWith(clientRecipient, key, msg)\n    } else {\n      triggerEvent(clientRecipient, key, data.message)\n    }\n  }\n}\n\n// When doing singular operations and we retrieve an error this function will throw that error\nfunction processResponse (path, result) {\n  const isSingularOperation = typeof path === 'string'\n\n  if (!isSingularOperation) {\n    return result\n  }\n\n  // CRUFT: When framework starts always appending errors we can remove the extra results.errors check\n  const err = result.errors && result.errors[path]\n  if (err) {\n    throw createError(err)\n  }\n\n  return result\n}\n\nfunction isOriginValid (origin) {\n  if (origin) {\n    const WHITELISTED_ORIGINS = [\n      /^https?:\\/\\/127.0.0.1(:\\d+)?$/,\n      /^https?:\\/\\/localhost(:\\d+)?$/,\n      /^https:\\/\\/.+\\.zendesk\\.com$/,\n      /^https:\\/\\/.+\\.zd-staging\\.com$/,\n      /^https:\\/\\/.+\\.zd-dev\\.com$/,\n      /^https:\\/\\/.+\\.zd-master\\.com$/,\n      /^https:\\/\\/.+\\.zendesk-staging\\.com$/,\n      /^https:\\/\\/.+\\.zendesk-dev\\.com$/,\n      // Zendesk Chat domains:\n      /^https?:\\/\\/.+\\.zopim\\.com(:\\d+)?$/,\n      /^https:\\/\\/dashboard\\.zopim\\.org$/,\n      // Zendesk Sell domains:\n      /^https:\\/\\/.+\\.futuresimple\\.com$/,\n      /^https:\\/\\/.+\\.cloudhatchery\\.com$/,\n      /^https:\\/\\/.+\\.idealwith\\.com$/,\n      // Tesco domains:\n      /^https:\\/\\/.+\\.ourtesco\\.com$/\n    ]\n\n    for (let i = 0; i < WHITELISTED_ORIGINS.length; i++) {\n      if (WHITELISTED_ORIGINS[i].test(origin)) {\n        return true\n      }\n    }\n  }\n\n  return false\n}\n\nfunction clearDocument () {\n  document.body = document.createElement('body')\n\n  const iframeHead = document.head\n  iframeHead && iframeHead.remove()\n}\n\nfunction appendErrorToBody (errorMsg) {\n  var errorElement = document.createElement('h3')\n  var errorTextNode = document.createTextNode(errorMsg)\n\n  errorElement.appendChild(errorTextNode)\n  document.body.appendChild(errorElement)\n}\n\nexport default class Client {\n  constructor (options) {\n    this._parent = options.parent\n    this._origin = options.origin || (this._parent && this._parent._origin)\n    this._source = options.source || (this._parent && this._parent._source) || window.parent\n    this._appGuid = options.appGuid || (this._parent && this._parent._appGuid)\n    this._instanceGuid = options.instanceGuid || this._appGuid\n    this._messageHandlers = {}\n    this._repliesPending = {}\n    this._instanceClients = {}\n    this._metadata = null\n    this._context = options.context || null\n    this._idleState = null\n    this.ready = false\n\n    if (!isOriginValid(this._origin)) {\n      const originHostname = new URL(this._origin).hostname\n      this.postMessage('__track__', {\n        event_name: 'invalid_sdk_origin',\n        event_type: 'increment',\n        data: 1,\n        tags: ['origin:' + originHostname]\n      })\n\n      clearDocument()\n      appendErrorToBody(`Invalid domain ${this._origin}`)\n    }\n\n    this.on('app.registered', (data) => {\n      this.ready = true\n      this._metadata = data.metadata\n      this._context = data.context\n      this._idleState = new IdleState()\n      this._idleState.addObserver(debounce(() => {\n        this.postMessage('session.live')\n      }, 1000))\n    }, this)\n\n    this.on('context.updated', (context) => {\n      this._context = context\n    }, this)\n\n    if (this._parent) {\n      this.ready = this._parent.ready\n      return this // shortcut handshake\n    }\n\n    const tracker = new Tracker(this)\n    tracker.setup()\n    window.addEventListener('message', messageHandler.bind(null, this))\n    this.postMessage('iframe.handshake', { version: pkgJson.version })\n  }\n\n  /**\n   * ### Client Object\n   *\n   * #### client.postMessage(name, [data])\n   *\n   * Allows you to send message events to the Zendesk app.\n   *\n   * ##### Arguments\n   *\n   *   * `name` the name of the message event. This determines the name of the iframe\n   *     event your app will receive. For example, if you set this to 'hello', your app will receive\n   *     the event 'iframe.hello'\n   *   * `data` (optional) a JSON object with any data that you want to pass along with the\n   *     event\n   *\n   * ```javascript\n   * const client = ZAFClient.init();\n   * client.postMessage('hello', { awesome: true });\n   * ``\n   */\n  postMessage (name, data) {\n    const msg = JSON.stringify({ key: name, message: data, appGuid: this._appGuid, instanceGuid: this._instanceGuid })\n    rawPostMessage(this, msg, name === 'iframe.handshake')\n  }\n\n  /**\n   * #### client.on(name, handler, [context])\n   *\n   * Allows you to add handlers to a framework event. You can add as many handler as you wish.\n   * They will be executed in the order they were added.\n   *\n   * ##### Arguments\n   *\n   *   * `name` the name of the framework event you want to listen to. This can be\n   *     [framework](./events.html#framework-events), [request](./events.html#request-events), or\n   *     [custom](./events.html#custom-events) events. Your iframe can listen to any events your app\n   *     receives, apart from DOM events. You don't need to register these events in the app first\n   *   * `handler` a function to be called when this event fires. You can expect to receive the same\n   *     event object your app would receive, parsed as JSON\n   *   * `context` (optional) the value of `this` within your handler\n   *\n   * ```javascript\n   * const client = ZAFClient.init();\n   * client.on('app.registered', (e) => {\n   *   // go nuts\n   * });\n   * ```\n   *\n   * Note: As soon as communication with the Zendesk app is established, the SDK triggers an\n   * `app.registered` event. You can add as many handlers to `app.registered` as you like. They're\n   * called immediately after the `init` callback\n   */\n  on (name, handler, context) {\n    if (typeof handler === 'function') {\n      handler = context\n        ? handler.bind(context)\n        : handler\n\n      this._messageHandlers[name] = this._messageHandlers[name] || []\n      this._messageHandlers[name].push(handler)\n\n      if (name !== 'app.registered') {\n        // Subscriber count is needed as the framework will only bind events on the first attached handler\n        this.postMessage('iframe.on:' + name, { subscriberCount: this._messageHandlers[name].length })\n      }\n    }\n  }\n\n  /**\n   * #### client.off(name, handler)\n   *\n   * Allows you to remove a handler for a framework event.\n   *\n   * ##### Arguments\n   *\n   *   * `name` the name of the event\n   *   * `handler` the function you attached earlier with `on`\n   *\n   * ```javascript\n   * const client = ZAFClient.init();\n   *\n   * client.on('app.registered', function appRegistered(e) {\n   *   // do stuff then remove the handler\n   *   client.off('app.registered', appRegistered);\n   * });\n   * ``\n   */\n  off (name, handler) {\n    if (!this._messageHandlers[name]) { return false }\n    const index = this._messageHandlers[name].indexOf(handler)\n    if (this.has(name, handler)) {\n      this._messageHandlers[name].splice(index, 1)\n    }\n\n    // Subscriber count is needed as the framework will only unbind events on the last detached handler (count of 0)\n    this.postMessage('iframe.off:' + name, { subscriberCount: this._messageHandlers[name].length })\n    return handler\n  }\n\n  /**\n   * #### client.has(name, handler)\n   *\n   * Returns whether or not an event has the specified handler attached to it.\n   *\n   * ##### Arguments\n   *\n   *   * `name` the name of the event\n   *   * `handler` the handler you want to test\n   *\n   * ```javascript\n   * const client = ZAFClient.init();\n   *\n   * client.on('app.registered', function appRegistered(e) {\n   *   // do stuff\n   * });\n   *\n   * client.has('app.registered', appRegistered); // true\n   * client.has('app.activated', appRegistered); // false\n   * ``\n   */\n  has (name, handler) {\n    if (!this._messageHandlers[name]) { return false }\n    return this._messageHandlers[name].indexOf(handler) !== -1\n  }\n\n  /**\n   * #### client.trigger(name, [data])\n   *\n   * Triggers the specified event on the client.\n   *\n   * ##### Arguments\n   *\n   *   * `name` the name of the event you want to trigger\n   *   * `data` (optional) data you want to pass to the handler\n   *\n   * ```javascript\n   * const client = ZAFClient.init();\n   *\n   * client.on('activation', () => {\n   *   console.log('activating!')\n   * });\n   *\n   * client.trigger('activation') // activating!\n   * ``\n   */\n  trigger (name, data) {\n    this.postMessage('iframe.trigger:' + name, data)\n  }\n\n  /**\n   * #### client.request(options)\n   *\n   * Dispatch [requests](./requests) via the Zendesk app.\n   *\n   * ##### Arguments\n   *\n   *   * `options` the url of the request or an options object containing a url key/value\n   *\n   * ##### Returns\n   *\n   * A [Promises/A+](https://promisesaplus.com) conformant `promise` object.\n   *\n   * ```javascript\n   * const client = ZAFClient.init();\n   *\n   * client.request('/api/v2/tickets.json').then(\n   *   (tickets) => {\n   *     console.log(tickets);\n   *   },\n   *   (response) => {\n   *     console.error(response.responseText);\n   *   }\n   * );\n   * ``\n   */\n  request (options) {\n    if (this._parent) { return this._parent.request(options) }\n    const requestKey = 'request:' + nextIdFor('request')\n\n    return new Promise((resolve, reject) => {\n      if (typeof options === 'string') {\n        options = { url: options }\n      }\n\n      const doneEventKey = `${requestKey}.done`\n      const failEventKey = `${requestKey}.fail`\n\n      const doneHandler = (evt) => {\n        resolve.apply(this, evt.responseArgs)\n        this.off(failEventKey, failHandler)\n        this.off(doneEventKey, doneHandler)\n      }\n\n      const failHandler = (evt) => {\n        reject.apply(this, evt.responseArgs)\n        this.off(failEventKey, failHandler)\n        this.off(doneEventKey, doneHandler)\n      }\n\n      this.on(doneEventKey, doneHandler)\n      this.on(failEventKey, failHandler)\n\n      this.postMessage(requestKey, options)\n    })\n  }\n\n  instance (instanceGuid) {\n    if (!instanceGuid || typeof instanceGuid !== 'string') {\n      throw new Error('The instance method expects an `instanceGuid` string.')\n    }\n    if (instanceGuid === this._instanceGuid) { return this }\n    if (this._parent) { return this._parent.instance(instanceGuid) }\n    let instanceClient = this._instanceClients[instanceGuid]\n    if (!instanceClient) {\n      instanceClient = new Client({\n        parent: this,\n        instanceGuid: instanceGuid\n      })\n      this._instanceClients[instanceGuid] = instanceClient\n    }\n    return instanceClient\n  }\n\n  metadata () {\n    if (this._parent) { return this._parent.metadata() }\n    return new Promise((resolve) => {\n      if (this._metadata) {\n        resolve(this._metadata)\n      } else {\n        this.on('app.registered', () => {\n          resolve(this._metadata)\n        })\n      }\n    })\n  }\n\n  context () {\n    if (this._context) {\n      return Promise.resolve(this._context)\n    } else {\n      if (this._instanceGuid && this._instanceGuid !== this._appGuid) {\n        const key = 'instances.' + this._instanceGuid\n        return this.get(key).then((data) => {\n          this._context = data[key]\n          return this._context\n        })\n      } else {\n        return new Promise((resolve) => {\n          this.on('app.registered', (data) => {\n            resolve(data.context)\n          })\n        })\n      }\n    }\n  }\n\n  // Accepts string or array of strings.\n  get (path) {\n    const paths = Array.isArray(path) ? path : [path]\n\n    if (arguments.length > 1 || paths.some((path) => { return !isString(path) })) {\n      throw new Error('The get method accepts a string or array of strings.')\n    }\n\n    return wrappedPostMessage.call(this, 'get', paths).then(processResponse.bind(null, path))\n  }\n\n  set (key, val) {\n    let obj = key\n\n    if (typeof key === 'string') {\n      if (arguments.length === 1) {\n        throw new Error('The setter requires a value')\n      }\n      obj = {}\n      obj[key] = val\n    }\n\n    if (!isObject(obj) || Array.isArray(obj)) {\n      throw new Error('The set method accepts a key and value pair, or an object of key and value pairs.')\n    }\n\n    return wrappedPostMessage.call(this, 'set', obj).then(processResponse.bind(null, key))\n  }\n\n  invoke (keyOrObject) {\n    let obj = {}\n\n    if (typeof keyOrObject === 'string') {\n      obj[keyOrObject] = Array.prototype.slice.call(arguments, 1)\n    } else if (typeof keyOrObject === 'object') {\n      // Validate object\n      Object.keys(keyOrObject).forEach((key) => {\n        const methodArgs = keyOrObject[key]\n\n        if (!Array.isArray(methodArgs) || methodArgs.some((arg) => { return !isString(arg) })) {\n          throw new Error('Invoke supports string arguments or an object with array of strings.')\n        }\n      })\n\n      obj = keyOrObject\n    } else {\n      throw new Error('Invoke supports string arguments or an object with array of strings.')\n    }\n\n    return wrappedPostMessage.call(this, 'invoke', obj).then(processResponse.bind(null, keyOrObject))\n  }\n}\n","import Client from './client'\nimport { queryParameters } from './utils'\n\n/**\n * ### ZAFClient API\n *\n * When you include the ZAF SDK on your website, you get access to the `ZAFClient` object.\n *\n * #### ZAFClient.init([callback(context)])\n *\n * Returns a [`client`](#client-object) object.\n *\n * ##### Arguments\n *\n *   * `callback(context)` (optional) a function called as soon as communication with\n *     the Zendesk app is established. The callback receives a context object with\n *     data related to the Zendesk app, including `currentAccount`, `currentUser`, and `location`\n *\n * Example:\n *\n * ```javascript\n * const client = ZAFClient.init((context) => {\n *   const currentUser = context.currentUser;\n *   console.log('Hi ' + currentUser.name);\n * });\n * ```\n */\n\nconst ZAFClient = {\n  init: function (callback, loc) {\n    loc = loc || window.location\n    const queryParams = queryParameters(loc.search)\n    const hashParams = queryParameters(loc.hash)\n    const origin = queryParams.origin || hashParams.origin\n    const appGuid = queryParams.app_guid || hashParams.app_guid\n    if (!origin || !appGuid) { return false }\n\n    const client = new Client({ origin, appGuid })\n\n    if (typeof callback === 'function') {\n      client.on('app.registered', callback.bind(client))\n    }\n\n    return client\n  }\n}\n\nexport default ZAFClient\n","/*! Native Promise Only\n    v0.8.1 (c) Kyle Simpson\n    MIT License: http://getify.mit-license.org\n*/\n\n(function UMD(name,context,definition){\n\t// special form of UMD for polyfilling across evironments\n\tcontext[name] = context[name] || definition();\n\tif (typeof module != \"undefined\" && module.exports) { module.exports = context[name]; }\n\telse if (typeof define == \"function\" && define.amd) { define(function $AMD$(){ return context[name]; }); }\n})(\"Promise\",typeof global != \"undefined\" ? global : this,function DEF(){\n\t/*jshint validthis:true */\n\t\"use strict\";\n\n\tvar builtInProp, cycle, scheduling_queue,\n\t\tToString = Object.prototype.toString,\n\t\ttimer = (typeof setImmediate != \"undefined\") ?\n\t\t\tfunction timer(fn) { return setImmediate(fn); } :\n\t\t\tsetTimeout\n\t;\n\n\t// dammit, IE8.\n\ttry {\n\t\tObject.defineProperty({},\"x\",{});\n\t\tbuiltInProp = function builtInProp(obj,name,val,config) {\n\t\t\treturn Object.defineProperty(obj,name,{\n\t\t\t\tvalue: val,\n\t\t\t\twritable: true,\n\t\t\t\tconfigurable: config !== false\n\t\t\t});\n\t\t};\n\t}\n\tcatch (err) {\n\t\tbuiltInProp = function builtInProp(obj,name,val) {\n\t\t\tobj[name] = val;\n\t\t\treturn obj;\n\t\t};\n\t}\n\n\t// Note: using a queue instead of array for efficiency\n\tscheduling_queue = (function Queue() {\n\t\tvar first, last, item;\n\n\t\tfunction Item(fn,self) {\n\t\t\tthis.fn = fn;\n\t\t\tthis.self = self;\n\t\t\tthis.next = void 0;\n\t\t}\n\n\t\treturn {\n\t\t\tadd: function add(fn,self) {\n\t\t\t\titem = new Item(fn,self);\n\t\t\t\tif (last) {\n\t\t\t\t\tlast.next = item;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tfirst = item;\n\t\t\t\t}\n\t\t\t\tlast = item;\n\t\t\t\titem = void 0;\n\t\t\t},\n\t\t\tdrain: function drain() {\n\t\t\t\tvar f = first;\n\t\t\t\tfirst = last = cycle = void 0;\n\n\t\t\t\twhile (f) {\n\t\t\t\t\tf.fn.call(f.self);\n\t\t\t\t\tf = f.next;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t})();\n\n\tfunction schedule(fn,self) {\n\t\tscheduling_queue.add(fn,self);\n\t\tif (!cycle) {\n\t\t\tcycle = timer(scheduling_queue.drain);\n\t\t}\n\t}\n\n\t// promise duck typing\n\tfunction isThenable(o) {\n\t\tvar _then, o_type = typeof o;\n\n\t\tif (o != null &&\n\t\t\t(\n\t\t\t\to_type == \"object\" || o_type == \"function\"\n\t\t\t)\n\t\t) {\n\t\t\t_then = o.then;\n\t\t}\n\t\treturn typeof _then == \"function\" ? _then : false;\n\t}\n\n\tfunction notify() {\n\t\tfor (var i=0; i<this.chain.length; i++) {\n\t\t\tnotifyIsolated(\n\t\t\t\tthis,\n\t\t\t\t(this.state === 1) ? this.chain[i].success : this.chain[i].failure,\n\t\t\t\tthis.chain[i]\n\t\t\t);\n\t\t}\n\t\tthis.chain.length = 0;\n\t}\n\n\t// NOTE: This is a separate function to isolate\n\t// the `try..catch` so that other code can be\n\t// optimized better\n\tfunction notifyIsolated(self,cb,chain) {\n\t\tvar ret, _then;\n\t\ttry {\n\t\t\tif (cb === false) {\n\t\t\t\tchain.reject(self.msg);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (cb === true) {\n\t\t\t\t\tret = self.msg;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tret = cb.call(void 0,self.msg);\n\t\t\t\t}\n\n\t\t\t\tif (ret === chain.promise) {\n\t\t\t\t\tchain.reject(TypeError(\"Promise-chain cycle\"));\n\t\t\t\t}\n\t\t\t\telse if (_then = isThenable(ret)) {\n\t\t\t\t\t_then.call(ret,chain.resolve,chain.reject);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tchain.resolve(ret);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcatch (err) {\n\t\t\tchain.reject(err);\n\t\t}\n\t}\n\n\tfunction resolve(msg) {\n\t\tvar _then, self = this;\n\n\t\t// already triggered?\n\t\tif (self.triggered) { return; }\n\n\t\tself.triggered = true;\n\n\t\t// unwrap\n\t\tif (self.def) {\n\t\t\tself = self.def;\n\t\t}\n\n\t\ttry {\n\t\t\tif (_then = isThenable(msg)) {\n\t\t\t\tschedule(function(){\n\t\t\t\t\tvar def_wrapper = new MakeDefWrapper(self);\n\t\t\t\t\ttry {\n\t\t\t\t\t\t_then.call(msg,\n\t\t\t\t\t\t\tfunction $resolve$(){ resolve.apply(def_wrapper,arguments); },\n\t\t\t\t\t\t\tfunction $reject$(){ reject.apply(def_wrapper,arguments); }\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tcatch (err) {\n\t\t\t\t\t\treject.call(def_wrapper,err);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t\telse {\n\t\t\t\tself.msg = msg;\n\t\t\t\tself.state = 1;\n\t\t\t\tif (self.chain.length > 0) {\n\t\t\t\t\tschedule(notify,self);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcatch (err) {\n\t\t\treject.call(new MakeDefWrapper(self),err);\n\t\t}\n\t}\n\n\tfunction reject(msg) {\n\t\tvar self = this;\n\n\t\t// already triggered?\n\t\tif (self.triggered) { return; }\n\n\t\tself.triggered = true;\n\n\t\t// unwrap\n\t\tif (self.def) {\n\t\t\tself = self.def;\n\t\t}\n\n\t\tself.msg = msg;\n\t\tself.state = 2;\n\t\tif (self.chain.length > 0) {\n\t\t\tschedule(notify,self);\n\t\t}\n\t}\n\n\tfunction iteratePromises(Constructor,arr,resolver,rejecter) {\n\t\tfor (var idx=0; idx<arr.length; idx++) {\n\t\t\t(function IIFE(idx){\n\t\t\t\tConstructor.resolve(arr[idx])\n\t\t\t\t.then(\n\t\t\t\t\tfunction $resolver$(msg){\n\t\t\t\t\t\tresolver(idx,msg);\n\t\t\t\t\t},\n\t\t\t\t\trejecter\n\t\t\t\t);\n\t\t\t})(idx);\n\t\t}\n\t}\n\n\tfunction MakeDefWrapper(self) {\n\t\tthis.def = self;\n\t\tthis.triggered = false;\n\t}\n\n\tfunction MakeDef(self) {\n\t\tthis.promise = self;\n\t\tthis.state = 0;\n\t\tthis.triggered = false;\n\t\tthis.chain = [];\n\t\tthis.msg = void 0;\n\t}\n\n\tfunction Promise(executor) {\n\t\tif (typeof executor != \"function\") {\n\t\t\tthrow TypeError(\"Not a function\");\n\t\t}\n\n\t\tif (this.__NPO__ !== 0) {\n\t\t\tthrow TypeError(\"Not a promise\");\n\t\t}\n\n\t\t// instance shadowing the inherited \"brand\"\n\t\t// to signal an already \"initialized\" promise\n\t\tthis.__NPO__ = 1;\n\n\t\tvar def = new MakeDef(this);\n\n\t\tthis[\"then\"] = function then(success,failure) {\n\t\t\tvar o = {\n\t\t\t\tsuccess: typeof success == \"function\" ? success : true,\n\t\t\t\tfailure: typeof failure == \"function\" ? failure : false\n\t\t\t};\n\t\t\t// Note: `then(..)` itself can be borrowed to be used against\n\t\t\t// a different promise constructor for making the chained promise,\n\t\t\t// by substituting a different `this` binding.\n\t\t\to.promise = new this.constructor(function extractChain(resolve,reject) {\n\t\t\t\tif (typeof resolve != \"function\" || typeof reject != \"function\") {\n\t\t\t\t\tthrow TypeError(\"Not a function\");\n\t\t\t\t}\n\n\t\t\t\to.resolve = resolve;\n\t\t\t\to.reject = reject;\n\t\t\t});\n\t\t\tdef.chain.push(o);\n\n\t\t\tif (def.state !== 0) {\n\t\t\t\tschedule(notify,def);\n\t\t\t}\n\n\t\t\treturn o.promise;\n\t\t};\n\t\tthis[\"catch\"] = function $catch$(failure) {\n\t\t\treturn this.then(void 0,failure);\n\t\t};\n\n\t\ttry {\n\t\t\texecutor.call(\n\t\t\t\tvoid 0,\n\t\t\t\tfunction publicResolve(msg){\n\t\t\t\t\tresolve.call(def,msg);\n\t\t\t\t},\n\t\t\t\tfunction publicReject(msg) {\n\t\t\t\t\treject.call(def,msg);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tcatch (err) {\n\t\t\treject.call(def,err);\n\t\t}\n\t}\n\n\tvar PromisePrototype = builtInProp({},\"constructor\",Promise,\n\t\t/*configurable=*/false\n\t);\n\n\t// Note: Android 4 cannot use `Object.defineProperty(..)` here\n\tPromise.prototype = PromisePrototype;\n\n\t// built-in \"brand\" to signal an \"uninitialized\" promise\n\tbuiltInProp(PromisePrototype,\"__NPO__\",0,\n\t\t/*configurable=*/false\n\t);\n\n\tbuiltInProp(Promise,\"resolve\",function Promise$resolve(msg) {\n\t\tvar Constructor = this;\n\n\t\t// spec mandated checks\n\t\t// note: best \"isPromise\" check that's practical for now\n\t\tif (msg && typeof msg == \"object\" && msg.__NPO__ === 1) {\n\t\t\treturn msg;\n\t\t}\n\n\t\treturn new Constructor(function executor(resolve,reject){\n\t\t\tif (typeof resolve != \"function\" || typeof reject != \"function\") {\n\t\t\t\tthrow TypeError(\"Not a function\");\n\t\t\t}\n\n\t\t\tresolve(msg);\n\t\t});\n\t});\n\n\tbuiltInProp(Promise,\"reject\",function Promise$reject(msg) {\n\t\treturn new this(function executor(resolve,reject){\n\t\t\tif (typeof resolve != \"function\" || typeof reject != \"function\") {\n\t\t\t\tthrow TypeError(\"Not a function\");\n\t\t\t}\n\n\t\t\treject(msg);\n\t\t});\n\t});\n\n\tbuiltInProp(Promise,\"all\",function Promise$all(arr) {\n\t\tvar Constructor = this;\n\n\t\t// spec mandated checks\n\t\tif (ToString.call(arr) != \"[object Array]\") {\n\t\t\treturn Constructor.reject(TypeError(\"Not an array\"));\n\t\t}\n\t\tif (arr.length === 0) {\n\t\t\treturn Constructor.resolve([]);\n\t\t}\n\n\t\treturn new Constructor(function executor(resolve,reject){\n\t\t\tif (typeof resolve != \"function\" || typeof reject != \"function\") {\n\t\t\t\tthrow TypeError(\"Not a function\");\n\t\t\t}\n\n\t\t\tvar len = arr.length, msgs = Array(len), count = 0;\n\n\t\t\titeratePromises(Constructor,arr,function resolver(idx,msg) {\n\t\t\t\tmsgs[idx] = msg;\n\t\t\t\tif (++count === len) {\n\t\t\t\t\tresolve(msgs);\n\t\t\t\t}\n\t\t\t},reject);\n\t\t});\n\t});\n\n\tbuiltInProp(Promise,\"race\",function Promise$race(arr) {\n\t\tvar Constructor = this;\n\n\t\t// spec mandated checks\n\t\tif (ToString.call(arr) != \"[object Array]\") {\n\t\t\treturn Constructor.reject(TypeError(\"Not an array\"));\n\t\t}\n\n\t\treturn new Constructor(function executor(resolve,reject){\n\t\t\tif (typeof resolve != \"function\" || typeof reject != \"function\") {\n\t\t\t\tthrow TypeError(\"Not a function\");\n\t\t\t}\n\n\t\t\titeratePromises(Constructor,arr,function resolver(idx,msg){\n\t\t\t\tresolve(msg);\n\t\t\t},reject);\n\t\t});\n\t});\n\n\treturn Promise;\n});\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\n__webpack_require__(632);\nvar __webpack_exports__ = __webpack_require__(303);\n"],"names":["root","factory","exports","module","define","amd","self","listeners_1","require","USER_EVENTS","constructor","this","hasFocus","userEventListenerAdded","observers","default","refcount","handleVisibilityChange","bind","handleFocusChange","handleUserEvent","document","addEventListener","window","delete","undefined","removeEventListener","forEach","type","markActive","call","event","includes","target","hidden","addObserver","observer","add","listeners","listener","find","findIndex","item","fn","index","push","count","splice","_len","arguments","length","args","Array","_key","Promise","NativePromise","decode","s","decodeURIComponent","replace","queryParameters","queryString","keyValuePairs","keyAndValue","key","value","result","search","slice","split","i","isPromise","obj","then","shouldReject","val","Error","isString","when","items","resolveAll","rejectAll","allResolvedPromise","resolve","reject","remaining","settledWith","itemsCopy","isArray","promise","res","err","data","resolveWith","catch","Tracker","client","startTime","Date","now","MIN_HOVER_TIME","handleMouseEnter","handleMouseLeave","overFor","invoke","handleClick","setup","$html","querySelector","PROMISE_TIMEOUT_LONG","NO_TIMEOUT_ACTIONS","ZAF_EVENT","pendingPromises","ids","defaultTimer","actions","callback","setTimeout","trackSDKRequestTimeout","collateActions","name","params","map","action","concat","requestResponseTime","actionsTags","stripActionArgs","responseTimeTag","upperLimit","lowerRangeBound","timeMsToSecondsRange","postMessage","event_name","event_type","tags","nextIdFor","isNaN","rawPostMessage","msg","forceReady","ready","_source","_origin","on","wrappedPostMessage","timeoutId","promiseStartTime","id","paramsArray","Object","keys","performance","matches","filter","indexOf","NaN","timeoutReject","JSON","stringify","request","appGuid","_appGuid","instanceGuid","_instanceGuid","removePromise","trackTimeoutWithResolutionTime","promiseResolutionTime","createError","error","path","message","stack","options","clearTimeout","messageHandler","origin","source","isValidEvent","parse","e","pendingPromise","clientRecipient","recipientGuid","messageRecipient","_instanceClients","getMessageRecipient","finalizePendingPromise","test","needsReply","_repliesPending","_messageHandlers","reason","rejectMessage","postReplyWith","eventName","handler","triggerEvent","processResponse","errors","Client","_parent","parent","_metadata","_context","context","_idleState","WHITELISTED_ORIGINS","isOriginValid","originHostname","URL","hostname","body","createElement","iframeHead","head","remove","clearDocument","errorMsg","errorElement","errorTextNode","createTextNode","appendChild","metadata","IdleState","func","timeout","time","_this","apply","debounce","version","pkgJson","subscriberCount","off","has","trigger","requestKey","url","doneEventKey","failEventKey","doneHandler","evt","responseArgs","failHandler","instance","instanceClient","get","paths","some","set","isObject","keyOrObject","prototype","methodArgs","arg","init","loc","queryParams","location","hashParams","hash","app_guid","definition","g","builtInProp","cycle","scheduling_queue","ToString","toString","timer","setImmediate","defineProperty","config","writable","configurable","schedule","drain","isThenable","o","_then","o_type","notify","chain","notifyIsolated","state","success","failure","cb","ret","TypeError","triggered","def","def_wrapper","MakeDefWrapper","iteratePromises","Constructor","arr","resolver","rejecter","idx","MakeDef","executor","__NPO__","first","last","Item","next","f","PromisePrototype","len","msgs","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","d","a","enumerable","globalThis","Function","prop","hasOwnProperty","__webpack_exports__"],"sourceRoot":""}